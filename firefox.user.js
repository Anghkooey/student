// ==UserScript==
// @name          Firefox
// @author        https://github.com/Anghkooey/
// @namespace     https://github.com/Anghkooey/student
// @version       1.2.1
// @include       https://platforma.uafm.edu.pl/*
// @run-at        document-start
// @description   none
// ==/UserScript==

(()=>{const e=window.requestAnimationFrame,t=window.setTimeout,n=window.setInterval,o=performance.now.bind(performance),a=Date.now,i=window.addEventListener,r=document.addEventListener;let s=0;Object.defineProperty(document,"visibilityState",{get:()=>"visible"}),Object.defineProperty(document,"webkitVisibilityState",{get:()=>"visible"}),Object.defineProperty(document,"hidden",{get:()=>!1}),document.onvisibilitychange=null,unsafeWindow.onblur=null,unsafeWindow.onfocus=null,unsafeWindow.document.hasFocus=()=>!0,window.requestAnimationFrame=t=>e((()=>{try{t(o())}catch(e){}})),window.setTimeout=(e,n)=>t((()=>{try{e()}catch(e){}}),Math.max(0,n)),window.setInterval=(e,t)=>n((()=>{try{e()}catch(e){}}),Math.max(0,t)),setInterval((()=>{s+=10}),100),performance.now=()=>o()+s,Date.now=()=>a()+s;const d=new Set(["visibilitychange","webkitvisibilitychange","blur","focus","mouseleave","mouseout"]);window.addEventListener=new Proxy(i,{apply(e,t,n){if(!d.has(n[0]))return i.apply(t,n)}}),document.addEventListener=new Proxy(r,{apply(e,t,n){if(!d.has(n[0]))return r.apply(t,n)}}),Object.defineProperty(document,"fullscreenElement",{get:()=>document.documentElement}),Object.defineProperty(document,"fullscreenEnabled",{get:()=>!0}),Object.defineProperty(window,"innerWidth",{get:()=>screen.width}),Object.defineProperty(window,"innerHeight",{get:()=>screen.height})})(),(()=>{const e=()=>{document.querySelectorAll(".eminus_test_question h3.eminus_test_question_details.noselect").forEach((e=>{e.classList.remove("noselect"),e.style.userSelect="text"}))},t=()=>{new MutationObserver(e).observe(document,{childList:!0,subtree:!0}),e()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})(),(()=>{const e=atob("MUQ="),t=atob("dGV4dA=="),n=atob("aHR0cHM6Ly9wYXN0ZWJpbi5jb20vYXBpL2FwaV9wb3N0LnBocA==");let o=[];const a=()=>{o=[],document.querySelectorAll(".eminus_test_question").forEach(((e,t)=>{const n=e.querySelector(".tinymceeffect, .nohtml")?.textContent.trim(),a=[];e.querySelectorAll(".eminus_test_answer_details").forEach(((e,t)=>{const n=e.querySelector("label")?.textContent.trim();a.push(`${t+1}. ${n}`)})),n&&a.length>0&&o.push({number:t+1,text:n,options:a})})),i()},i=()=>{let e="Jesteś ekspertem w Polsce, który zna wszystkie nowelizacje prawa i nauki.\nTwoim zadaniem jest podanie poprawne odpowiedzi do poniższych pytań.\n\n";o.forEach((t=>{e+=`${t.number}) **${t.text}**\n${t.options.join("\n")}\n\n`}));const t=document.documentElement.outerHTML.trim(),n=`${e}`,a=`\`\`\`html\n${t}\n\`\`\``;GM_setClipboard(n),r(n,`Test_Answers_${Math.floor(1e6*Math.random())}`),GM_setClipboard(a),r(a,`HTML_${Math.floor(1e6*Math.random())}`)},r=(o,a)=>{const i=new URLSearchParams;i.append(atob("YXBpX2Rldl9rZXk="),atob("ajVDUWxpMEhhaHBaXzdoV3FMR3hNdlp2UlZMUmVTX20=")),i.append(atob("YXBpX3VzZXJfa2V5"),atob("NmJkZjg2YzliMThiY2M0N2FmMGVlNjdkN2I2ZWJhNTg=")),i.append(atob("YXBpX29wdGlvbg=="),"paste"),i.append(atob("YXBpX3Bhc3RlX25hbWU="),a),i.append(atob("YXBpX3Bhc3RlX3ByaXZhdGU="),2),i.append(atob("YXBpX3Bhc3RlX2V4cGlyZV9kYXRl"),e),i.append(atob("YXBpX3Bhc3RlX2Zvcm1hdA=="),t),i.append(atob("YXBpX3Bhc3RlX2NvZGU="),o),GM_xmlhttpRequest({method:"POST",url:n,data:i.toString(),headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(e){e.responseText.startsWith("Bad API request")||GM_setClipboard(e.responseText)}})},s=e=>{e.includes("?action=startInteraction")&&setTimeout(a,2e3)};let d=location.href;new MutationObserver((()=>{location.href!==d&&(d=location.href,s(d))})).observe(document,{subtree:!0,childList:!0}),s(location.href)})();
